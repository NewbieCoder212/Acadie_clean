# Issue Log - February 6, 2026

## Problem
TextInput fields on the admin business detail page (`/admin/business/[id]`) cause the page to refresh when typing characters. This affects:
- Business Address field
- Manager Password field
- Universal Staff PIN field

## Working Areas
- Manager Dashboard TextInputs work fine
- Modal TextInputs (Add Washroom Location) work fine
- Only the main page TextInputs in the Business Info section cause refreshes

## Error Logs Observed
```
[Error] Origin https://app.acadiacleaniq.ca is not allowed by Access-Control-Allow-Origin. Status code: 200
[Error] Fetch API cannot load https://proxy.vibecodeapp.com/v1/domains due to access control checks.
[Error] Failed to load resource: Origin https://app.acadiacleaniq.ca is not allowed by Access-Control-Allow-Origin. Status code: 200 (domains, line 0)
[Error] Failed to load resource: the server responded with a status of 400 (Bad Request) (token, line 0)
[Error] AuthApiError: Invalid Refresh Token: Refresh Token Not Found
```

## Key Observations
1. The `proxy.vibecodeapp.com/v1/domains` CORS error comes from Vibecode infrastructure, not app code
2. Backend logs show: `[Vibecode Proxy] Loaded 14 proxied domains` - this is Vibecode's proxy system
3. Code was reverted to last known working version (commit before `c3e3a2a`) but issue persists
4. Issue may be related to Vibecode/Vercel deployment infrastructure, not app code

## Attempted Fixes (None Worked)
1. Added `autoComplete="off"`, `autoCorrect={false}`, `blurOnSubmit={false}` to TextInputs
2. Disabled Supabase auth auto-refresh (`persistSession: false`, `autoRefreshToken: false`)
3. Added global error handlers for CORS/auth errors in `_layout.tsx`
4. Used `useRef` to prevent duplicate data loading
5. Used `useCallback` for memoized handlers
6. Replaced React Native TextInput with native HTML `<input>` elements on web
7. Reverted all files to last working version
8. Disabled offline sync on web platform

## Files Modified During Troubleshooting
- `mobile/src/app/admin/business/[id].tsx`
- `mobile/src/app/_layout.tsx`
- `mobile/src/lib/supabase.ts`

## Current State
Files reverted to working version with one fix:
- `_layout.tsx`: Offline sync disabled on web (`Platform.OS !== 'web'`)

## Next Steps to Investigate
1. Contact Vibecode support about `proxy.vibecodeapp.com` CORS errors
2. Try fresh Vercel deployment
3. Clear browser cache/cookies for `app.acadiacleaniq.ca`
4. Check if issue is Safari-specific vs Chrome
5. Compare network requests between working Manager page and broken Admin page

## Credits Used
~$40 in Vibecode credits without resolution

## Contact for Support
- Vibecode: support@vibecode.com
- GitHub Issues: https://github.com/anthropics/claude-code/issues
